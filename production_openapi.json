{"openapi":"3.1.0","info":{"title":"Underwriting Workbench API","description":"Backend API for insurance submission processing","version":"1.0.0"},"paths":{"/api/email/intake":{"post":{"summary":"Email Intake","description":"Process incoming email with attachments and extract insurance data","operationId":"email_intake_api_email_intake_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailIntakePayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailIntakeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/logicapps/email/intake":{"post":{"summary":"Logic Apps Email Intake","description":"Process incoming email from Logic Apps with native Logic Apps format","operationId":"logic_apps_email_intake_api_logicapps_email_intake_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogicAppsEmailPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailIntakeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/submissions/confirm/{submission_ref}":{"post":{"summary":"Confirm Submission","description":"Confirm a submission and assign to underwriter - Updates existing work item instead of creating duplicate","operationId":"confirm_submission_api_submissions_confirm__submission_ref__post","parameters":[{"name":"submission_ref","in":"path","required":true,"schema":{"type":"string","title":"Submission Ref"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubmissionConfirmRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubmissionConfirmResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/submissions":{"get":{"summary":"Get All Submissions","description":"Get all submissions with pagination","operationId":"get_all_submissions_api_submissions_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SubmissionResponse"},"title":"Response Get All Submissions Api Submissions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint with API information","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/debug/database":{"get":{"summary":"Debug Database","description":"Debug endpoint to check database connectivity and data","operationId":"debug_database_api_debug_database_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/work-items/{work_item_id}/status":{"put":{"summary":"Update Work Item Status","description":"Update work item status with business rule validation","operationId":"update_work_item_status_api_work_items__work_item_id__status_put","parameters":[{"name":"work_item_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Item Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","title":"Status Update"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/test/guidewire":{"get":{"summary":"Test Guidewire Connection","description":"Test Guidewire connection and authentication","operationId":"test_guidewire_connection_api_test_guidewire_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/test/outbound-ip":{"get":{"summary":"Test Outbound Ip","description":"Test what outbound IP address this app is using","operationId":"test_outbound_ip_api_test_outbound_ip_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/test/guidewire-submission":{"post":{"summary":"Test Guidewire Submission","description":"Test creating a complete Guidewire submission using sample data","operationId":"test_guidewire_submission_api_test_guidewire_submission_post","requestBody":{"content":{"application/json":{"schema":{"type":"object","title":"Test Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/test/guidewire-simple":{"post":{"summary":"Test Guidewire Simple Request","description":"Test a simple Guidewire request to debug the 400 error","operationId":"test_guidewire_simple_request_api_test_guidewire_simple_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/workitems/{work_item_id}/submit-to-guidewire":{"post":{"summary":"Submit Work Item To Guidewire","description":"Submit a work item to Guidewire PolicyCenter","operationId":"submit_work_item_to_guidewire_api_workitems__work_item_id__submit_to_guidewire_post","parameters":[{"name":"work_item_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Item Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/workitems/poll":{"get":{"summary":"Poll Workitems","description":"Enhanced polling for work items with filtering support and optional detailed data.\nNow includes risk assessment and history data when include_details=true or work_item_id specified.\n\nArgs:\n    since: ISO timestamp to filter items created after this time\n    limit: Maximum number of items to return (default 50, max 100)\n    search: Search term to filter across title, description, industry\n    priority: Filter by priority (Low, Moderate, Medium, High, Critical)\n    status: Filter by status (Pending, In Review, Approved, Rejected)\n    assigned_to: Filter by assigned underwriter\n    include_details: Include risk assessment and history data\n    work_item_id: Get details for specific work item (replaces separate endpoints)","operationId":"poll_workitems_api_workitems_poll_get","parameters":[{"name":"since","in":"query","required":false,"schema":{"type":"string","title":"Since"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"search","in":"query","required":false,"schema":{"type":"string","title":"Search"}},{"name":"priority","in":"query","required":false,"schema":{"type":"string","title":"Priority"}},{"name":"status","in":"query","required":false,"schema":{"type":"string","title":"Status"}},{"name":"assigned_to","in":"query","required":false,"schema":{"type":"string","title":"Assigned To"}},{"name":"include_details","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Include Details"}},{"name":"work_item_id","in":"query","required":false,"schema":{"type":"integer","title":"Work Item Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EnhancedPollingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/submissions/{submission_id}":{"put":{"summary":"Update Submission","description":"Update submission fields (for inline editing) - Also updates related work item","operationId":"update_submission_api_submissions__submission_id__put","parameters":[{"name":"submission_id","in":"path","required":true,"schema":{"type":"integer","title":"Submission Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","title":"Updates"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/workitems/{workitem_id}":{"put":{"summary":"Update Workitem","description":"Update work item fields (for inline editing)","operationId":"update_workitem_api_workitems__workitem_id__put","parameters":[{"name":"workitem_id","in":"path","required":true,"schema":{"type":"integer","title":"Workitem Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","title":"Updates"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/workitems/{workitem_id}/assign":{"post":{"summary":"Assign Workitem","description":"Assign work item to underwriter and create submission","operationId":"assign_workitem_api_workitems__workitem_id__assign_post","parameters":[{"name":"workitem_id","in":"path","required":true,"schema":{"type":"integer","title":"Workitem Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","title":"Assignment Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/underwriters":{"get":{"summary":"List Underwriters","description":"Get list of available underwriters","operationId":"list_underwriters_api_underwriters_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/refresh-data":{"get":{"summary":"Refresh Data","description":"Endpoint for frontend refresh functionality","operationId":"refresh_data_api_refresh_data_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/cleanup-duplicates":{"post":{"summary":"Cleanup Duplicate Work Items","description":"Cleanup duplicate work items - keeps the most recent one per submission","operationId":"cleanup_duplicate_work_items_api_cleanup_duplicates_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/debug/duplicates":{"get":{"summary":"Debug Duplicate Work Items","description":"Debug endpoint to identify duplicate work items","operationId":"debug_duplicate_work_items_api_debug_duplicates_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AttachmentPayload":{"properties":{"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Filename","description":"Name of the attachment file"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name","description":"Name of the attachment file (Logic Apps format)"},"contentBase64":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contentbase64","description":"Base64 encoded file content"},"contentBytes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contentbytes","description":"Base64 encoded file content (Logic Apps format)"},"contentType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contenttype","description":"MIME type of the attachment"}},"type":"object","title":"AttachmentPayload"},"CompanySizeEnum":{"type":"string","enum":["Small","Medium","Large","Enterprise"],"title":"CompanySizeEnum"},"EmailIntakePayload":{"properties":{"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject","description":"Email subject line"},"sender_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sender Email","description":"Email sender address"},"from_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"From Email","description":"Email sender address (legacy)"},"from":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"From","description":"Email sender address (Logic Apps format)"},"received_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Received At","description":"Email received timestamp"},"body":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Body","description":"Email body content"},"attachments":{"items":{"$ref":"#/components/schemas/AttachmentPayload"},"type":"array","title":"Attachments","description":"List of email attachments"}},"type":"object","title":"EmailIntakePayload"},"EmailIntakeResponse":{"properties":{"submission_ref":{"type":"string","title":"Submission Ref"},"submission_id":{"type":"string","title":"Submission Id"},"status":{"type":"string","title":"Status"},"message":{"type":"string","title":"Message"}},"type":"object","required":["submission_ref","submission_id","status","message"],"title":"EmailIntakeResponse"},"EnhancedPollingResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/WorkItemSummary"},"type":"array","title":"Items"},"count":{"type":"integer","title":"Count"},"timestamp":{"type":"string","title":"Timestamp"}},"type":"object","required":["items","count","timestamp"],"title":"EnhancedPollingResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LogicAppsAttachment":{"properties":{"name":{"type":"string","title":"Name","description":"Name of the attachment file"},"contentType":{"type":"string","title":"Contenttype","description":"MIME type of the attachment"},"contentBytes":{"type":"string","title":"Contentbytes","description":"Base64 encoded file content"}},"type":"object","required":["name","contentType","contentBytes"],"title":"LogicAppsAttachment","description":"Logic Apps specific attachment format"},"LogicAppsEmailPayload":{"properties":{"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject","description":"Email subject line","default":""},"from":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"From","description":"Email sender address","default":""},"received_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Received At","description":"Email received timestamp in ISO format","default":""},"receivedDateTime":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Receiveddatetime","description":"Email received timestamp (Logic Apps format)","default":""},"body":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Body","description":"Email body content","default":""},"attachments":{"items":{"$ref":"#/components/schemas/LogicAppsAttachment"},"type":"array","title":"Attachments","description":"List of email attachments"}},"type":"object","title":"LogicAppsEmailPayload","description":"Logic Apps specific email payload format"},"RiskCategories":{"properties":{"technical":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Technical","description":"Technical risk score (0-100)"},"operational":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Operational","description":"Operational risk score (0-100)"},"financial":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Financial","description":"Financial risk score (0-100)"},"compliance":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Compliance","description":"Compliance risk score (0-100)"}},"type":"object","required":["technical","operational","financial","compliance"],"title":"RiskCategories"},"SubmissionConfirmRequest":{"properties":{"underwriter_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Underwriter Email"}},"type":"object","title":"SubmissionConfirmRequest"},"SubmissionConfirmResponse":{"properties":{"submission_id":{"type":"string","title":"Submission Id"},"submission_ref":{"type":"string","title":"Submission Ref"},"work_item_id":{"type":"integer","title":"Work Item Id"},"assigned_to":{"type":"string","title":"Assigned To"},"task_status":{"type":"string","title":"Task Status"}},"type":"object","required":["submission_id","submission_ref","work_item_id","assigned_to","task_status"],"title":"SubmissionConfirmResponse"},"SubmissionResponse":{"properties":{"id":{"type":"integer","title":"Id"},"submission_id":{"type":"string","title":"Submission Id"},"submission_ref":{"type":"string","title":"Submission Ref"},"subject":{"type":"string","title":"Subject"},"sender_email":{"type":"string","title":"Sender Email"},"body_text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Body Text"},"attachment_content":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Attachment Content"},"extracted_fields":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Extracted Fields"},"assigned_to":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Assigned To"},"task_status":{"type":"string","title":"Task Status"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","submission_id","submission_ref","subject","sender_email","task_status"],"title":"SubmissionResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WorkItemPriorityEnum":{"type":"string","enum":["Low","Moderate","Medium","High","Critical"],"title":"WorkItemPriorityEnum"},"WorkItemStatusEnum":{"type":"string","enum":["Pending","In Review","Approved","Rejected"],"title":"WorkItemStatusEnum"},"WorkItemSummary":{"properties":{"id":{"type":"integer","title":"Id"},"submission_id":{"type":"integer","title":"Submission Id"},"submission_ref":{"type":"string","title":"Submission Ref"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"status":{"$ref":"#/components/schemas/WorkItemStatusEnum"},"priority":{"$ref":"#/components/schemas/WorkItemPriorityEnum"},"assigned_to":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Assigned To"},"risk_score":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Risk Score"},"risk_categories":{"anyOf":[{"$ref":"#/components/schemas/RiskCategories"},{"type":"null"}]},"industry":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Industry"},"company_size":{"anyOf":[{"$ref":"#/components/schemas/CompanySizeEnum"},{"type":"null"}]},"policy_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Policy Type"},"coverage_amount":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Coverage Amount"},"last_risk_assessment":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Risk Assessment"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"comments_count":{"type":"integer","title":"Comments Count","default":0},"has_urgent_comments":{"type":"boolean","title":"Has Urgent Comments","default":false},"extracted_fields":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Extracted Fields"}},"type":"object","required":["id","submission_id","submission_ref","status","priority","created_at","updated_at"],"title":"WorkItemSummary"}}}}